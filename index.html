<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Ball Knower - Sports Trivia Game</title>
    <link rel="stylesheet" href="styles.css?v=20">
    <link rel="stylesheet" href="auth-modal-styles.css?v=7">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700;900&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet"> 
</head>
<body>
    <div id="app">
        <!-- Navigation Header -->
        <nav class="navbar">
            <div class="nav-container">
                <div class="nav-logo">
                    <img src="ballknowerlogo.png" alt="Ball Knower Logo" class="logo-image">
                    <span>Ball Knower</span>
                </div>
                <div class="nav-menu">
                    <button class="nav-btn active" onclick="showHome()">
                        <i class="fas fa-home"></i>
                        <span>Home</span>
                    </button>
                    <button class="nav-btn" onclick="showLeaderboard()">
                        <i class="fas fa-trophy"></i>
                        <span>Leaderboard</span>
                    </button>
                    <button class="nav-btn" onclick="showProfile()">
                        <i class="fas fa-user"></i>
                        <span>Profile</span>
                    </button>
                </div>
                <div class="nav-xp">
                    <div class="xp-bar">
                        <div class="xp-fill" style="width: 65%;"></div>
                    </div>
                    <span class="xp-text">Level 5 ‚Ä¢ 650/1000 XP</span>
                </div>
            </div>
        </nav>

        <!-- Home Screen -->
        <div id="home-screen" class="screen active">
            <div class="hero-section">
                <div class="hero-banner" id="hero-banner">
                    <div class="hero-content">
                        <h1 class="main-title">Do you know ball?</h1>
                        <p class="hero-tagline">Compete with friends. Prove you really know ball.</p>
                        <button class="cta-button" onclick="quickPlay()">
                            <i class="fas fa-play"></i>
                            Play Now
                        </button>
                    </div>
                </div>
            </div>

            <!-- Personal Stats Preview -->
            <div class="stats-preview">
                <div class="stat-card">
                    <i class="fas fa-fire"></i>
                    <div class="stat-info">
                        <span class="stat-value" id="best-streak">0</span>
                        <span class="stat-label">Best Streak</span>
                    </div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-bullseye"></i>
                    <div class="stat-info">
                        <span class="stat-value" id="accuracy">0%</span>
                        <span class="stat-label">Accuracy</span>
                    </div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-gamepad"></i>
                    <div class="stat-info">
                        <span class="stat-value" id="games-played">0</span>
                        <span class="stat-label">Games Played</span>
                    </div>
                </div>
            </div>

            <!-- Leaderboards Row -->
            <div class="leaderboards-row">
                <!-- Top 3 Today Preview -->
                <div class="leaderboard-preview">
                    <h3><i class="fas fa-crown"></i> Top Ballers Today</h3>
                    <div class="top-players">
                        <div class="top-player">
                            <span class="rank gold">1</span>
                            <span class="player-name">Josh23</span>
                            <span class="player-score">42 <i class="fas fa-fire"></i></span>
                        </div>
                        <div class="top-player">
                            <span class="rank silver">2</span>
                            <span class="player-name">CourtVision</span>
                            <span class="player-score">38 <i class="fas fa-fire"></i></span>
                        </div>
                        <div class="top-player">
                            <span class="rank bronze">3</span>
                            <span class="player-name">HoopMaster</span>
                            <span class="player-score">35 <i class="fas fa-fire"></i></span>
                        </div>
                    </div>
                    <p class="challenge-text">Think you can beat Josh23's 42-streak? üî•</p>
                </div>

                <!-- Weekly Challenge Leaders Preview -->
                <div class="weekly-leaderboard-preview">
                    <h3><i class="fas fa-trophy"></i> Weekly Challenge Leaders</h3>
                    <div class="top-players" id="weekly-leaderboard-preview">
                        <div class="loading-message">Loading weekly standings...</div>
                    </div>
                    <p class="challenge-text">Who will finish #1 this week? üèÜ</p>
                </div>
            </div>


            <div class="game-modes">
                <h2 class="section-title">Choose Your Challenge</h2>
                <div class="mode-card" onclick="startGame('college-guesser')" data-mode="college">
                    <div class="mode-glow"></div>
                    <div class="mode-icon">
                        <i class="fas fa-graduation-cap"></i>
                    </div>
                    <h3>College Guesser</h3>
                    <p class="mode-tagline">üè´ Can you name where the legends came from?</p>
                </div>

                <div class="mode-card" onclick="startGame('jersey-guesser')" data-mode="jersey">
                    <div class="mode-glow"></div>
                    <div class="mode-icon jersey-flip">
                        <i class="fas fa-tshirt"></i>
                    </div>
                    <h3>Jersey Number Guesser</h3>
                    <p class="mode-tagline">üëï Match the icons to their legendary digits</p>
                </div>

                <div class="mode-card survival-mode" onclick="startGame('survival')" data-mode="survival">
                    <div class="mode-glow"></div>
                    <div class="mode-icon fire-icon">
                        <i class="fas fa-fire"></i>
                    </div>
                    <h3>Survival Mode</h3>
                    <p class="mode-tagline">üî• Don't choke... one wrong and you're out</p>
                    <div class="mode-stats">
                        <span><i class="fas fa-clock"></i> 20 sec</span>
                        <span><i class="fas fa-infinity"></i> Unlimited</span>
                    </div>
                </div>

                <div class="mode-card" onclick="startGame('achievement-guesser')" data-mode="trivia">
                    <div class="mode-glow"></div>
                    <div class="mode-icon">
                        <i class="fas fa-brain"></i>
                    </div>
                    <h3>Ball Trivia</h3>
                    <p class="mode-tagline">üìö Only true ball knowers survive this one</p>
                </div>

                <div class="mode-card multiplayer-mode" onclick="showMultiplayerSetup()" data-mode="multiplayer">
                    <div class="mode-glow"></div>
                    <div class="mode-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <h3>Multiplayer</h3>
                    <p class="mode-tagline">‚öîÔ∏è Battle it out. Winner takes all</p>
                    <div class="mode-stats">
                        <span><i class="fas fa-clock"></i> 1-5 min</span>
                        <span><i class="fas fa-users"></i> 2-8 players</span>
                    </div>
                </div>
            </div>

            <div class="recent-games">
                <h3>Recent Games</h3>
                <div class="game-list">
                    <div class="game-item">
                        <div class="game-info">
                            <span class="game-date">2 hours ago</span>
                        </div>
                        <div class="game-result">
                            <span class="score">8/10</span>
                            <span class="rating">Great!</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Game Setup Screen -->
        <div id="setup-screen" class="screen">
            <div class="setup-container enhanced-setup">
                <div class="setup-header">
                    <h2 id="setup-title" class="setup-title-enhanced">üéÆ Game Setup</h2>
                    <p class="setup-subtitle">Configure your perfect Ball Knower experience</p>
                </div>
                
                <div class="setup-section sport-selection">
                    <div class="section-header">
                        <h3><i class="fas fa-trophy"></i> Choose Your League</h3>
                        <p class="section-description">Which sport will test your knowledge?</p>
                    </div>
                    <div class="sport-options enhanced-options">
                        <button class="sport-btn enhanced-btn" onclick="selectSport('nfl')">
                            <div class="btn-icon">
                                <i class="fas fa-football-ball"></i>
                            </div>
                            <div class="btn-content">
                                <span class="btn-title">NFL</span>
                                <span class="btn-subtitle">National Football League</span>
                            </div>
                        </button>
                        <button class="sport-btn enhanced-btn" onclick="selectSport('nba')">
                            <div class="btn-icon">
                                <i class="fas fa-basketball-ball"></i>
                            </div>
                            <div class="btn-content">
                                <span class="btn-title">NBA</span>
                                <span class="btn-subtitle">National Basketball Assoc.</span>
                            </div>
                        </button>
                        <button class="sport-btn enhanced-btn" onclick="selectSport('both')">
                            <div class="btn-icon">
                                <i class="fas fa-fire"></i>
                            </div>
                            <div class="btn-content">
                                <span class="btn-title">Both</span>
                                <span class="btn-subtitle">Ultimate Challenge</span>
                            </div>
                        </button>
                    </div>
                </div>


                <div class="setup-section input-type-selection">
                    <div class="section-header">
                        <h3><i class="fas fa-gamepad"></i> Answer Style</h3>
                        <p class="section-description">How do you want to answer questions?</p>
                    </div>
                    <div class="input-type-options enhanced-options">
                        <button class="input-type-btn enhanced-btn active" onclick="selectInputType('multiple-choice')">
                            <div class="btn-icon">
                                <i class="fas fa-list"></i>
                            </div>
                            <div class="btn-content">
                                <span class="btn-title">Multiple Choice</span>
                                <span class="btn-subtitle">Pick from 4 options ‚Ä¢ 10s</span>
                            </div>
                        </button>
                        <button class="input-type-btn enhanced-btn" onclick="selectInputType('text-input')">
                            <div class="btn-icon">
                                <i class="fas fa-keyboard"></i>
                            </div>
                            <div class="btn-content">
                                <span class="btn-title">Type Answer</span>
                                <span class="btn-subtitle">Show your knowledge ‚Ä¢ 20s</span>
                            </div>
                        </button>
                    </div>
                </div>


                <!-- Game Mode Selection (for Survival Mode) -->
                <div id="game-mode-selection" class="game-mode-selection" style="display: none;">
                    <h3>Choose Game Modes</h3>
                    <p><strong>Select one or more game modes</strong> - You can choose any combination of the three modes below:</p>
                    <div class="mode-options">
                        <label class="mode-option">
                            <input type="checkbox" id="college-mode">
                            <span class="checkmark"></span>
                            <i class="fas fa-graduation-cap"></i>
                            College Guesser
                        </label>
                        <label class="mode-option">
                            <input type="checkbox" id="jersey-mode">
                            <span class="checkmark"></span>
                            <i class="fas fa-tshirt"></i>
                            Jersey Number Guesser
                        </label>
                        <label class="mode-option">
                            <input type="checkbox" id="trivia-mode" checked>
                            <span class="checkmark"></span>
                            <i class="fas fa-trophy"></i>
                            Ball Trivia
                        </label>
                    </div>
                    <div class="mode-selection-info">
                        <p><i class="fas fa-info-circle"></i> <strong>Tip:</strong> You can select 1, 2, or all 3 modes. Questions will be randomly chosen from your selected modes.</p>
                    </div>
                </div>

                <!-- Question Count (for regular modes) -->
                <div id="question-count-section" class="setup-section question-count">
                    <div class="section-header">
                        <h3><i class="fas fa-hashtag"></i> Question Count</h3>
                        <p class="section-description">How many questions can you handle?</p>
                    </div>
                    <div class="count-selector enhanced-counter">
                        <button class="counter-btn" onclick="changeQuestionCount(-1)">
                            <i class="fas fa-minus"></i>
                        </button>
                        <div class="counter-display">
                            <span id="question-count" class="counter-value">10</span>
                            <span class="counter-label">Questions</span>
                        </div>
                        <button class="counter-btn" onclick="changeQuestionCount(1)">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                </div>

                <!-- High Score Display -->
                <div id="high-score-display" class="high-score-display" style="display: none;">
                    <h3>üèÜ High Score</h3>
                    <div class="high-score-info">
                        <div class="score-item">
                            <span class="score-label">Best Streak:</span>
                            <span id="best-streak" class="score-value">0</span>
                        </div>
                        <div class="score-item">
                            <span class="score-label">Game Mode:</span>
                            <span id="best-mode" class="score-value">-</span>
                        </div>
                    </div>
                </div>

                <div class="game-controls">
                    <button class="btn-secondary" onclick="showHome()">Back</button>
                    <button class="btn-primary" onclick="startGameSession()">Start Game</button>
                </div>
            </div>
        </div>

        <!-- Game Screen -->
        <div id="game-screen" class="screen">
            <div class="game-header clean-header">
                <div class="header-top">
                    <div class="header-left">
                        <div class="sport-badge">
                            <i class="fas fa-trophy"></i>
                            <span id="current-sport-display">NFL</span>
                        </div>
                    </div>
                    <div class="header-center">
                        <div class="timer-badge center-timer">
                            <i class="fas fa-clock"></i>
                            <span id="timer">2:00</span>
                        </div>
                    </div>
                    <div class="header-right">
                        <div class="question-counter">
                            <span id="question-counter">Question 1 of 10</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="game-content clean-layout">
                <!-- Player Card -->
                <div class="player-card-clean" id="player-card">
                    <div class="player-info-clean">
                        <h3 id="player-name" class="player-name-clean">Michael Thomas</h3>
                        <p id="player-team" class="team-name-clean">New Orleans Saints</p>
                    </div>
                </div>

                <!-- Question Section -->
                <div class="question-section-clean">
                    <div class="question-icon-clean">
                        <i class="fas fa-question-circle"></i>
                    </div>
                    <h2 id="question-text" class="question-text-clean">Which college did Michael Thomas attend?</h2>
                </div>

                <!-- Answer Options -->
                <div class="answer-options-clean" id="answer-options">
                    <button class="answer-btn-clean" onclick="selectAnswer(0)">East Carolina</button>
                    <button class="answer-btn-clean" onclick="selectAnswer(1)">USC</button>
                    <button class="answer-btn-clean" onclick="selectAnswer(2)">Ohio State</button>
                    <button class="answer-btn-clean" onclick="selectAnswer(3)">Alabama</button>
                </div>
                
                <div class="text-input-container-clean" id="text-input-container" style="display: none;">
                    <input type="text" id="text-answer-input" placeholder="Type your answer here..." autocomplete="off">
                    <button class="submit-btn-clean" onclick="submitTextAnswer()">Submit</button>
                </div>

                <div class="question-image-container" id="question-image-container" style="display: none;">
                    <img id="question-image" src="" alt="Question Image">
                </div>
            </div>

            <div class="game-progress">
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 10%"></div>
                </div>
            </div>
        </div>

        <!-- Results Screen -->
        <div id="results-screen" class="screen">
            <div class="results-container">
                <h2>Game Complete!</h2>
                
                <div class="final-score">
                    <div class="score-circle">
                        <span class="score-number">8</span>
                        <span class="score-total">/10</span>
                    </div>
                    <h3>Great Job!</h3>
                    <p>You scored 80%</p>
                </div>

                <div class="results-breakdown">
                    <div class="stat-item">
                        <span class="stat-label">Correct Answers</span>
                        <span class="stat-value">8</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Time Used</span>
                        <span class="stat-value">1:45</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Streak</span>
                        <span class="stat-value">5</span>
                    </div>
                </div>

                <!-- High Score Display (Survival Mode Only) -->
                <div id="survival-high-score" class="survival-high-score" style="display: none;">
                    <h3>üèÜ Personal Best</h3>
                    <div class="high-score-comparison">
                        <div class="score-comparison">
                            <div class="current-score">
                                <span class="score-label">This Run</span>
                                <span id="current-streak" class="score-value">0</span>
                            </div>
                            <div class="vs-divider">vs</div>
                            <div class="best-score">
                                <span class="score-label">Best Ever</span>
                                <span id="best-streak-result" class="score-value">0</span>
                            </div>
                        </div>
                        <div class="best-modes">
                            <span class="modes-label">Best achieved with:</span>
                            <span id="best-modes-result" class="modes-value">-</span>
                        </div>
                    </div>
                </div>

                <div class="results-actions">
                    <button class="btn-secondary" onclick="showHome()">Home</button>
                    <button class="btn-primary" onclick="playAgain()">Play Again</button>
                </div>
            </div>
        </div>

        <!-- Leaderboard Screen -->
        <div id="leaderboard-screen" class="screen">
            <div class="leaderboard-container">
                <h2>Leaderboard</h2>
                
                <div class="leaderboard-tabs">
                    <button class="tab-btn active" onclick="showLeaderboardTab('weekly')">Weekly Challenge</button>
                    <button class="tab-btn" onclick="showLeaderboardTab('monthly')">This Month</button>
                    <button class="tab-btn" onclick="showLeaderboardTab('all-time')">All Time</button>
                </div>

                <!-- Weekly Challenge Leaderboard -->
                <div id="weekly-leaderboard" class="leaderboard-section active">
                    <div class="leaderboard-header">
                        <h3><i class="fas fa-trophy"></i> Weekly Challenge Standings</h3>
                        <p class="leaderboard-subtitle">Current week's picks leaderboard</p>
                    </div>
                    <div class="leaderboard-list" id="weekly-leaderboard-list">
                        <div class="loading-message">Loading weekly standings...</div>
                    </div>
                </div>

                <!-- Monthly Leaderboard -->
                <div id="monthly-leaderboard" class="leaderboard-section">
                    <div class="leaderboard-header">
                        <h3><i class="fas fa-calendar-alt"></i> Monthly Standings</h3>
                        <p class="leaderboard-subtitle">This month's top performers</p>
                    </div>
                    <div class="leaderboard-list" id="monthly-leaderboard-list">
                        <div class="leaderboard-item rank-1">
                            <div class="rank">1</div>
                            <div class="player-info">
                                <div class="player-details">
                                    <span class="player-name">John Doe</span>
                                    <span class="player-stats">15 games ‚Ä¢ 85% avg</span>
                                </div>
                            </div>
                            <div class="score">1,250</div>
                        </div>
                        
                        <div class="leaderboard-item">
                            <div class="rank">2</div>
                            <div class="player-info">
                                <div class="player-details">
                                    <span class="player-name">Jane Smith</span>
                                    <span class="player-stats">12 games ‚Ä¢ 82% avg</span>
                                </div>
                            </div>
                            <div class="score">1,180</div>
                        </div>

                        <div class="leaderboard-item">
                            <div class="rank">3</div>
                            <div class="player-info">
                                <div class="player-details">
                                    <span class="player-name">Mike Johnson</span>
                                    <span class="player-stats">18 games ‚Ä¢ 78% avg</span>
                                </div>
                            </div>
                            <div class="score">1,120</div>
                        </div>
                    </div>
                </div>

                <!-- All Time Leaderboard -->
                <div id="all-time-leaderboard" class="leaderboard-section">
                    <div class="leaderboard-header">
                        <h3><i class="fas fa-crown"></i> All Time Standings</h3>
                        <p class="leaderboard-subtitle">The greatest ball knowers of all time</p>
                    </div>
                    <div class="leaderboard-list" id="all-time-leaderboard-list">
                        <div class="leaderboard-item rank-1">
                            <div class="rank">1</div>
                            <div class="player-info">
                                <div class="player-details">
                                    <span class="player-name">John Doe</span>
                                    <span class="player-stats">15 games ‚Ä¢ 85% avg</span>
                                </div>
                            </div>
                            <div class="score">1,250</div>
                        </div>
                        
                        <div class="leaderboard-item">
                            <div class="rank">2</div>
                            <div class="player-info">
                                <div class="player-details">
                                    <span class="player-name">Jane Smith</span>
                                    <span class="player-stats">12 games ‚Ä¢ 82% avg</span>
                                </div>
                            </div>
                            <div class="score">1,180</div>
                        </div>

                        <div class="leaderboard-item">
                            <div class="rank">3</div>
                            <div class="player-info">
                                <div class="player-details">
                                    <span class="player-name">Mike Johnson</span>
                                    <span class="player-stats">18 games ‚Ä¢ 78% avg</span>
                                </div>
                            </div>
                            <div class="score">1,120</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Multiplayer Setup Screen -->
        <div id="multiplayer-setup-screen" class="screen">
            <div class="setup-container">
                <h2>Multiplayer Setup</h2>
                
                <div id="multiplayer-options" class="multiplayer-options">
                    <div class="option-card" onclick="createRoom()">
                        <div class="option-icon">
                            <i class="fas fa-plus-circle"></i>
                        </div>
                        <h3>Create Room</h3>
                        <p>Start a new game room and invite friends</p>
                    </div>
                    
                    <div class="option-card" onclick="showJoinRoom()">
                        <div class="option-icon">
                            <i class="fas fa-sign-in-alt"></i>
                        </div>
                        <h3>Join Room</h3>
                        <p>Enter a room code to join an existing game</p>
                    </div>
                </div>

                <!-- Room Creation Setup -->
                <div class="room-setup" id="room-setup" style="display: none;">
                    <h3>Game Setup</h3>
                    <div class="setup-options">
                        <div class="option-group">
                            <label>Sport:</label>
                            <div class="sport-buttons">
                                <button class="sport-btn active" data-sport="nfl" onclick="selectSport('nfl')">NFL</button>
                                <button class="sport-btn" data-sport="nba" onclick="selectSport('nba')">NBA</button>
                                <button class="sport-btn" data-sport="both" onclick="selectSport('both')">Both</button>
                            </div>
                        </div>
                        
                        <div class="option-group">
                            <label>Game Modes (Select Multiple):</label>
                            <div class="mode-buttons">
                                <button class="mode-btn active" data-mode="trivia" onclick="toggleMode('trivia')">Ball Trivia</button>
                                <button class="mode-btn" data-mode="college" onclick="toggleMode('college')">College Guesser</button>
                                <button class="mode-btn" data-mode="jersey" onclick="toggleMode('jersey')">Jersey Guesser</button>
                            </div>
                            <div class="mode-info">
                                <small>Questions will be randomly selected from your chosen modes</small>
                            </div>
                        </div>
                        
                        <div class="option-group">
                            <label>Input Type:</label>
                            <div class="input-buttons">
                                <button class="input-btn active" data-input="multiple" onclick="selectInput('multiple')">Multiple Choice</button>
                                <button class="input-btn" data-input="type" onclick="selectInput('type')">Type Answer</button>
                            </div>
                        </div>
                        
                        <div class="option-group">
                            <label>Game Duration:</label>
                            <div class="duration-buttons">
                                <button class="duration-btn active" data-duration="60" onclick="selectDuration(60)">1 min</button>
                                <button class="duration-btn" data-duration="120" onclick="selectDuration(120)">2 min</button>
                                <button class="duration-btn" data-duration="180" onclick="selectDuration(180)">3 min</button>
                                <button class="duration-btn" data-duration="240" onclick="selectDuration(240)">4 min</button>
                                <button class="duration-btn" data-duration="300" onclick="selectDuration(300)">5 min</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="game-controls">
                        <button class="btn-secondary" onclick="showMultiplayerSetup()">Cancel</button>
                        <button class="btn-primary" onclick="createRoomWithSettings()">Create Room</button>
                    </div>
                </div>

                <div class="room-code-input" id="room-code-input" style="display: none;">
                    <h3>Enter Room Code</h3>
                    <input type="text" id="room-code" placeholder="Enter 6-digit code" maxlength="6">
                    <div class="game-controls">
                        <button class="btn-secondary" onclick="showMultiplayerSetup()">Back</button>
                        <button class="btn-primary" onclick="joinRoom()">Join Room</button>
                    </div>
                </div>

                <div class="created-room" id="created-room" style="display: none;">
                    <h3>Room Created!</h3>
                    <div class="room-info">
                        <div class="room-code-display">
                            <span>Room Code:</span>
                            <span id="display-room-code">ABC123</span>
                            <button class="copy-btn" onclick="copyRoomCode()">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <div class="game-settings-display" id="game-settings-display"></div>
                        <div class="players-list" id="players-list">
                            <h4>Players in Room</h4>
                            <div class="player-item">
                                <i class="fas fa-user"></i>
                                <span>You (Host)</span>
                            </div>
                        </div>
                    </div>
                    <div class="game-controls">
                        <button class="btn-secondary" onclick="showMultiplayerSetup()">Cancel</button>
                        <button class="btn-secondary" onclick="simulatePlayerJoin()">Test: Add Player</button>
                        <button class="btn-primary" onclick="startMultiplayerGame()">Start Game</button>
                    </div>
                </div>

                <div class="game-controls">
                    <button class="btn-secondary" onclick="showHome()">Back to Home</button>
                </div>
            </div>
        </div>

        <!-- Multiplayer Game Screen -->
        <div id="multiplayer-waiting-screen" class="screen">
            <div class="waiting-container">
                <div class="waiting-header">
                    <h2>Waiting for Players</h2>
                    <div class="room-info">
                        <span class="room-code">Room: <span id="waiting-room-code">ABC123</span></span>
                    </div>
                </div>
                
                <div class="waiting-content">
                    <div class="game-settings-summary" id="waiting-game-settings">
                        <!-- Game settings will be displayed here -->
                    </div>
                    
                    <div class="players-waiting" id="players-waiting">
                        <h3>Players in Room</h3>
                        <div class="players-list" id="waiting-players-list">
                            <!-- Players will be populated here -->
                        </div>
                    </div>
                    
                    <div class="waiting-status" id="waiting-status">
                        <div class="status-message">
                            <i class="fas fa-clock"></i>
                            <span id="status-text">Waiting for more players...</span>
                        </div>
                        <div class="countdown" id="game-countdown" style="display: none;">
                            <span>Game starting in: </span>
                            <span id="countdown-timer">10</span>
                        </div>
                    </div>
                </div>
                
                <div class="waiting-controls">
                    <button class="btn-secondary" onclick="leaveWaitingRoom()">Leave Room</button>
                    <button class="btn-primary" id="start-game-btn" onclick="startGameCountdown()" style="display: none;">Start Game</button>
                </div>
            </div>
        </div>

        <div id="multiplayer-game-screen" class="screen">
            <div class="game-container">
                <div class="game-header">
                    <div class="room-info">
                        <span class="room-code">Room: <span id="current-room-code">ABC123</span></span>
                        <span class="time-remaining" id="time-remaining">1:00</span>
                    </div>
                    <div class="player-count">
                        <i class="fas fa-users"></i>
                        <span id="player-count">1</span> players
                    </div>
                </div>

                <div class="question-container" id="question-container">
                    <div class="question-card">
                        <div class="question-text" id="multiplayer-question-text">Loading question...</div>
                        <div class="question-options" id="question-options">
                            <!-- Options will be populated here -->
                        </div>
                        <div class="text-input-container" id="text-input-container" style="display: none;">
                            <input type="text" id="text-answer" placeholder="Type your answer..." maxlength="50">
                            <button class="submit-btn" onclick="submitTextAnswer()">Submit</button>
                        </div>
                    </div>
                </div>

                <div class="current-score" id="current-score">
                    <h3>Your Score</h3>
                    <div class="score-display" id="current-player-score">0</div>
                </div>
                
                <div class="opponent-answers" id="opponent-answers" style="display: none;">
                    <h3>Opponent Answers</h3>
                    <div class="opponent-list" id="opponent-list">
                        <!-- Opponent answers will be shown here -->
                    </div>
                </div>

                <div class="game-controls">
                    <button class="btn-secondary" onclick="leaveMultiplayerGame()">Leave Game</button>
                </div>
            </div>
        </div>

        <!-- Multiplayer Results Screen -->
        <div id="multiplayer-results-screen" class="screen">
            <div class="results-container">
                <div class="results-header">
                    <h2>Game Results</h2>
                    <div class="room-info">
                        <span class="room-code">Room: <span id="results-room-code">ABC123</span></span>
                    </div>
                </div>
                
                <div class="results-content">
                    <div class="winner-announcement" id="winner-announcement">
                        <!-- Winner will be displayed here -->
                    </div>
                    
                    <div class="final-leaderboard" id="final-leaderboard">
                        <h3>Final Scores</h3>
                        <div class="leaderboard-list" id="final-leaderboard-list">
                            <!-- Final scores will be populated here -->
                        </div>
                    </div>
                    
                    <div class="game-stats" id="game-stats">
                        <!-- Game statistics will be displayed here -->
                    </div>
                </div>
                
                <div class="results-controls">
                    <button class="btn-secondary" onclick="playAgainMultiplayer()">Play Again</button>
                    <button class="btn-primary" onclick="returnToHome()">Return to Home</button>
                </div>
            </div>
        </div>

        <!-- Profile Screen -->
        <div id="profile-screen" class="screen">
            <div class="profile-container">
                <div class="profile-header">
                    <div class="profile-info">
                        <h2>Player Name</h2>
                        <p>Member since January 2024</p>
                    </div>
                </div>

                <div class="profile-stats">
                    <div class="stat-card">
                        <div class="stat-number" id="total-games">0</div>
                        <div class="stat-label">Games Played</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="average-score">0%</div>
                        <div class="stat-label">Average Score</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="best-streak">0</div>
                        <div class="stat-label">Best Streak</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="achievements-earned">0</div>
                        <div class="stat-label">Achievements</div>
                    </div>
                </div>

                <div class="achievements">
                    <h3>Achievements</h3>
                    <div class="achievement-list" id="achievement-list">
                        <!-- Achievements will be populated by JavaScript -->
                    </div>
                </div>

                <div class="profile-actions">
                    <button class="btn-secondary" onclick="signOut()">Sign Out</button>
                </div>
            </div>
        </div>
    </div>

    <script src="well_known_players.js"></script>
    <script src="nfl_trivia_embedded.js"></script>
    <script src="nba_trivia_embedded.js"></script>
    <script src="utils/triviaLoader.js"></script>
    <script>
        // Fallback data in case well_known_players.js doesn't load on GitHub Pages
        if (typeof WELL_KNOWN_PLAYERS === 'undefined') {
            console.log('‚ö†Ô∏è Loading fallback player data...');
            window.WELL_KNOWN_PLAYERS = [
                {"id": "nfl_tom_brady", "name": "Tom Brady", "team": "Tampa Bay Buccaneers", "college": "Michigan", "jersey": 12, "position": "QB", "league": "NFL"},
                {"id": "nfl_peyton_manning", "name": "Peyton Manning", "team": "Denver Broncos", "college": "Tennessee", "jersey": 18, "position": "QB", "league": "NFL"},
                {"id": "nfl_aaron_rodgers", "name": "Aaron Rodgers", "team": "New York Jets", "college": "California", "jersey": 8, "position": "QB", "league": "NFL"},
                {"id": "nfl_drew_brees", "name": "Drew Brees", "team": "New Orleans Saints", "college": "Purdue", "jersey": 9, "position": "QB", "league": "NFL"},
                {"id": "nfl_russell_wilson", "name": "Russell Wilson", "team": "Denver Broncos", "college": "Wisconsin", "jersey": 3, "position": "QB", "league": "NFL"}
            ];
            console.log('‚úÖ Fallback data loaded: 5 players');
        }
    </script>
    <script src="utils/dataLoader.js?v=1"></script>
    <script src="script.js?v=11"></script>
</div>

<!-- Weekly Challenge Modal -->
<div id="weekly-challenge-modal" class="challenge-modal" onclick="handleModalClick(event)">
    <div class="challenge-modal-content" onclick="event.stopPropagation()">
        <div class="challenge-modal-header">
            <h2 class="challenge-modal-title" id="modal-title">Ball Knower Weekly Challenge</h2>
            <button class="challenge-modal-close" onclick="closeWeeklyChallengeModal()">&times;</button>
        </div>
        
        <div class="challenge-modal-body">
            <!-- STATE: AUTH (Sign In / Create Account) -->
            <div id="state-auth" class="modal-state active">
                <div class="auth-tabs">
                    <button class="auth-tab active" id="signin-tab" onclick="switchToSignInTab()">Sign In</button>
                    <button class="auth-tab" id="create-tab" onclick="switchToCreateTab()">Create Account</button>
                </div>
                
                <!-- Create Account Form -->
                <form id="challenge-register-form" class="auth-form" style="display: none;" onsubmit="handleChallengeRegister(event)">
                    <div class="form-group">
                        <label for="register-username">Username</label>
                        <input type="text" id="register-username" placeholder="ballknower23" required minlength="3">
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="register-firstname">First Name</label>
                            <input type="text" id="register-firstname" placeholder="John" required minlength="2">
                        </div>
                        <div class="form-group">
                            <label for="register-lastname">Last Name</label>
                            <input type="text" id="register-lastname" placeholder="Doe" required minlength="2">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="register-email">Email</label>
                        <input type="email" id="register-email" placeholder="your@email.com" required>
                    </div>
                    <div class="form-group">
                        <label for="register-password">Password</label>
                        <input type="password" id="register-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required minlength="6">
                    </div>
                    <div class="form-group">
                        <label for="register-confirm-password">Confirm Password</label>
                        <input type="password" id="register-confirm-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required minlength="6">
                    </div>
                    <button type="submit" class="auth-btn-primary">
                        Create Account
                    </button>
                </form>
                
                <!-- Sign In Form (Default) -->
                <form id="challenge-login-form" class="auth-form" onsubmit="handleChallengeLogin(event)">
                    <div class="form-group">
                        <label for="login-username">Username</label>
                        <input type="text" id="login-username" placeholder="ballknower23" required minlength="3">
                    </div>
                    <div class="form-group">
                        <label for="login-email">Email</label>
                        <input type="email" id="login-email" placeholder="your@email.com" required>
                    </div>
                    <div class="form-group">
                        <label for="login-password">Password</label>
                        <input type="password" id="login-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                    </div>
                    <button type="submit" class="auth-btn-primary">
                        Sign In
                    </button>
                </form>
            </div>
            
            <!-- STATE: START (shown when signed in and not completed) -->
            <div id="state-start" class="modal-state">
                <div class="start-content">
                    <h3>Ready for this week's challenge?</h3>
                    <p>Make your picks and answer trivia to climb the leaderboard!</p>
                    <button class="auth-btn-primary" onclick="showState('picks')">
                        üèà Start Weekly Challenge
                    </button>
                    <button class="auth-btn-secondary" onclick="signOut()">
                        Sign Out
                    </button>
                </div>
            </div>
            
            <!-- STATE: PICKS (5 games with confidence) -->
            <div id="state-picks" class="modal-state">
                <div class="picks-content">
                    <h3>üèà Make Your Picks</h3>
                    <p>Pick 10 games (5 NFL + 5 College Football) - Select either the favorite or underdog for each game.</p>
                    <p>You'll earn 1 point for each correct pick!</p>
                    <div id="picks-form">
                        <div class="picks-loading">Loading games...</div>
                    </div>
                </div>
            </div>
            
            
            <!-- STATE: THANK YOU -->
            <div id="state-thank-you" class="modal-state">
                <div class="thank-you-card">
                    <h3>Thanks for playing! üéâ</h3>
                    <p>Your picks have been submitted and will be graded after the games finish.</p>
                    <p>Check back after the games to see your score on the leaderboard!</p>
                    <div class="thank-you-actions">
                        <button class="auth-btn-primary" onclick="closeWeeklyChallengeModal()">
                            Exit
                        </button>
                        <button class="auth-btn-secondary" onclick="viewLeaderboard()">
                            View Leaderboard
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- LEGACY: Profile View (will be removed) -->
            <div id="challenge-overview-step" class="challenge-step" style="display: none;">
                <div class="profile-view">
                    <div class="profile-header">
                        <div class="profile-avatar">
                            <span id="user-avatar-initials">U</span>
                        </div>
                        <h3 id="user-display-name">User</h3>
                        <p id="user-email">user@example.com</p>
                    </div>
                    
                    <div class="profile-stats">
                        <div class="stat-card">
                            <div class="stat-value" id="user-picks-points">0</div>
                            <div class="stat-label">Picks Points</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="user-trivia-points">0</div>
                            <div class="stat-label">Trivia Points</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="user-streak">0</div>
                            <div class="stat-label">Current Streak</div>
                        </div>
                    </div>
                    
                    <div class="profile-achievements">
                        <h4>üèÜ Achievements</h4>
                        <div id="user-achievements" class="achievements-list">
                            <p class="no-achievements">No achievements yet</p>
                        </div>
                    </div>
                    
                    <div class="profile-actions">
                        <button class="auth-btn-primary" onclick="startWeeklyChallenge()">Start Weekly Challenge</button>
                        <button class="auth-btn-secondary" onclick="signOut()">Sign Out</button>
                    </div>
                </div>
            </div>
            
            <!-- Step 3: Challenge Interface (shown when starting challenge) -->
            <div id="challenge-interface-step" class="challenge-step" style="display: none;">
                <div class="challenge-header">
                    <h3>üèà Week 5 Challenge</h3>
                    <p>Make your picks and answer trivia to climb the leaderboard!</p>
                </div>
                
                <div class="challenge-content">
                    <div class="challenge-section">
                        <h4>üìä Your Progress</h4>
                        <div class="progress-stats">
                            <div class="stat-item">
                                <span class="stat-label">Picks Made</span>
                                <span class="stat-value" id="picks-progress">0/3</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Trivia Answered</span>
                                <span class="stat-value" id="trivia-progress">0/3</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Total Points</span>
                                <span class="stat-value" id="total-points">0</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="challenge-section">
                        <h4>üéØ This Week's Games</h4>
                        <div class="picks-form" id="picks-form">
                            <div class="picks-loading">Loading games...</div>
                        </div>
                    </div>
                    
                    <div class="challenge-section" id="trivia-step" style="display: none;">
                        <h4>üß† Trivia Questions (5 Questions, 10 seconds each)</h4>
                        <div class="trivia-questions" id="trivia-questions">
                            <div class="trivia-loading">Loading trivia questions...</div>
                        </div>
                    </div>
                </div>
                
                <div class="challenge-actions">
                    <button class="challenge-btn-secondary" onclick="closeWeeklyChallengeModal()">Close</button>
                    <button class="challenge-btn-primary" onclick="submitWeeklyPicks()">Submit Picks</button>
                </div>
            </div>
        </div>
        
        <div class="challenge-modal-footer">
            <p>üîí No betting. No payments. Just friendly competition.</p>
        </div>
    </div>
</div>

    <script src="auth-functions.js?v=4"></script>
    <script src="weekly_challenge_games.js"></script>
    <script src="weekly-challenge.js?v=37"></script>
    <script>
        console.log('üè† HTML VERSION 2 LOADED - CACHE BUSTED!');
        console.log('HTML has correct onclick handlers:', document.querySelector('[data-mode="trivia"]').onclick.toString().includes('toggleMode'));
    </script>
</body>
</html>
